<h3 class="hl">Medical/Medicare Summary</h3>
<p class="text-muted">
	Medical and Medicare Summary Screen
</p>
<hr/>

<div class="row form-row">
	<h4 class="hl bottom-15">Medical Bills Summary<i class="fa fa-chevron-up toggle"></i></h4>
	<div>
		<table class="table table-striped table-hover " id="presentJobSummary">
			<thead>
				<tr style="background: #ddd">
					<th>Who</th>
					<th>Bill Type</th>
					<th>Bill Amount</th>
					<th style="width: 8%">Edit</th>
					<th style="width: 8%">Delete</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td colspan="5" id="medicalBillsSummaryNA">Not Applicable</td>
				</tr>
			</tbody>
		</table>
		
		<div class="col-md-12">
			<div class="panel panel-light">
            	<div class="panel-heading">
                	<h3 class="panel-title">Add Present Job</h3>
                </div>
                 <div class="panel-body">
                   	<div class="col-md-6">
                   		<select class="form-control memberNames">
							<OPTION VALUE="SEL" TITLE="Select" SELECTED>Select</OPTION>
						</select>
                   	</div>
                   	<div class="col-md-2">
                   		<button type="button" onclick="javascript:addIncome('present-job');" class="btn btn-green pull-right btn-block">Add Present Job</button>
                   	</div>
                 </div>
             </div>
		</div>		
	</div>
</div>


<script>
var db = TAFFY(sessionStorage.db);
$(document).ready(function(){
	sessionStorage.currentScreen = "medical-summary.html";
	$(this).resetLeftNavLinks("#billsNavLink");
	
	//db({type:"member", incomeSection:"active"}).update({incomeSection:"completed", editMode: false, addMode: false, editIncomeId: null});
	//sessionStorage.db = db().stringify();

	$.get( "/commonhelp-svcs/services/medicaid/applicant/medical/summary?applicationId="+sessionStorage.applicationId, function( data ) {
		if(data.medicalDataList != null){
			var medicalDataList =  data.medicalDataList;
			$.each(medicalDataList, function(index, memberMedicalData) {
				$.each(memberMedicalData.medicalBills, function(index, medicalBill) {
					var memberId = memberMedicalData.memberId
					var memberInfo = db({id:memberId}).first();
					
					$("#medicalBillsSummaryNA").hide();

					if(medicalBill.amount > 0){
						appendMedicalBills(medicalBill, memberInfo);
					}
				});
				
			});
		}
	});	
});

function appendMedicalBills(medicalBill, member){
	$('#presentJobSummary tr').last().after(
	    	'<tr style="height: 50px;">'+
				'<td>'+member.firstName+" "+member.lastName+'</td>'+
				'<td>'+medicalBill.type+'</td>'+
				'<td>'+medicalBill.amount+'</td>'+
				'<td><button type="button" class="btn btn-blue" onclick="javascript:editIncome(\''+member.id+'\', \'present-job\')">Edit</button></td>'+
				'<td><button type="button" class="btn btn-red" onclick="javascript:deleteIncome(\''+member.id+'\')">Delete</button></td>'+
			'</tr>');

}

</script>